# Classifying Images with Vision and Core ML

# Core ML & Create ML Image Classifier

Welcome to the Core ML & Create ML Image Classifier project! This project demonstrates how to build an image classification model using Core ML and Create ML, and how to integrate it into an iOS app with a view controller for selecting images and applying Vision + Core ML processing.

## Table of Contents
- [Introduction](#introduction)
- [Prerequisites](#prerequisites)
- [Project Setup](#project-setup)
- [Creating the Model](#creating-the-model)
- [Integrating the Model](#integrating-the-model)
  - [1. View Controller for Selecting Images and Applying Vision + Core ML Processing](#1-view-controller-for-selecting-images-and-applying-vision--core-ml-processing)
  - [2. Using the Swift Class `MobileNet` Generated by Core ML](#2-using-the-swift-class-mobilenet-generated-by-core-ml)
  - [3. Handling General Image Processing Errors](#3-handling-general-image-processing-errors)
  - [4. Updating the UI with Classification Results](#4-updating-the-ui-with-classification-results)
  - [5. Handling Classification Observations](#5-handling-classification-observations)
  - [6. Showing Options for the Source Picker](#6-showing-options-for-the-source-picker)
  - [7. Handling Image Picker Selection](#7-handling-image-picker-selection)
- [Contributing](#contributing)
- [License](#license)

## Introduction

In this project, we will create an image classification model using Core ML and Create ML, and integrate it into an iOS app. The app will allow users to select images and apply the classification model to identify the contents of the images.

## Prerequisites

Before you begin, make sure you have the following prerequisites installed:
- macOS 10.14 or later
- Xcode 10 or later
- Swift 4.2 or later
- A dataset of labeled images

## Project Setup

1. **Open Xcode**: Launch Xcode and create a new iOS project.

2. **Add the Core ML Model**: Download or create a Core ML model (e.g., `MobileNet.mlmodel`) and add it to your Xcode project.

3. **Import Required Frameworks**: Ensure you import the following frameworks in your project:
    ```swift
    import UIKit
    import CoreML
    import Vision
    import ImageIO
    ```

## Creating the Model

1. **Open Create ML**: Launch Create ML from Xcode by going to `Xcode > Open Developer Tool > Create ML`.

2. **Create a New Image Classifier**: Select `New Document` and choose `Image Classifier`.

3. **Import the Dataset**: Drag and drop your dataset into the training section and start the training process.

4. **Export the Model**: Once training is complete, export the model as a `.mlmodel` file and add it to your Xcode project.

## Integrating the Model

### 1. View Controller for Selecting Images and Applying Vision + Core ML Processing

Create a view controller with an image picker to select images and apply the Core ML model using Vision.

```swift
class ViewController: UIViewController, UIImagePickerControllerDelegate, UINavigationControllerDelegate {
    @IBOutlet weak var imageView: UIImageView!
    @IBOutlet weak var classificationLabel: UILabel!
    
    let imagePicker = UIImagePickerController()
    
    override func viewDidLoad() {
        super.viewDidLoad()
        imagePicker.delegate = self
        classificationLabel.text = "Select an image to classify."
    }
    
    @IBAction func selectImage(_ sender: UIButton) {
        if UIImagePickerController.isSourceTypeAvailable(.camera) {
            showSourcePicker()
        } else {
            showPhotoLibrary()
        }
    }
    
    func showSourcePicker() {
        let alert = UIAlertController()
        
        if UIImagePickerController.isSourceTypeAvailable(.camera) {
            alert.addAction(UIAlertAction(title: "Camera", style: .default) { _ in
                self.showCamera()
            })
        }
        
        alert.addAction(UIAlertAction(title: "Photo Library", style: .default) { _ in
            self.showPhotoLibrary()
        })
        
        present(alert, animated: true)
    }
    
    func showCamera() {
        imagePicker.sourceType = .camera
        present(imagePicker, animated: true)
    }
    
    func showPhotoLibrary() {
        imagePicker.sourceType = .photoLibrary
        present(imagePicker, animated: true)
    }
    
    func imagePickerController(_ picker: UIImagePickerController, didFinishPickingMediaWithInfo info: [UIImagePickerController.InfoKey : Any]) {
        picker.dismiss(animated: true)
        guard let image = info[.originalImage] as? UIImage else {
            return
        }
        imageView.image = image
        classifyImage(image)
    }
}
